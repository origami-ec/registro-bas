<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="formaPagoDetalle" language="groovy" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="0" bottomMargin="0" uuid="65dc00b9-83f0-4951-a218-a9399e9c6d19">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="negrita" pdfFontName="Helvetica-Bold"/>
	<parameter name="IMG_URL" class="java.lang.String"/>
	<parameter name="DESDE" class="java.lang.String"/>
	<parameter name="USUARIO" class="java.lang.Long"/>
	<parameter name="TOTAL" class="java.math.BigDecimal"/>
	<parameter name="CANTIDAD" class="java.lang.Integer"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\Users\\Anyelo\\Desktop\\NetBeansProjects\\portoviejo-registro\\src\\main\\webapp\\reportes\\diarios\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="HASTA" class="java.lang.String"/>
	<parameter name="HASTA_STRING" class="java.lang.String"/>
	<parameter name="TESORERA" class="java.lang.String"/>
	<parameter name="COORDINADORA" class="java.lang.String"/>
	<parameter name="CONTADORA" class="java.lang.String"/>
	<queryString>
		<![CDATA[select sum(total_pagar)
+
(
SELECT coalesce(SUM(total_pagar),0) FROM financiero.ren_factura fa
left join financiero.ren_cajero ca on ca.id = fa.caja
left join app.acl_user us on us.id = ca.usuario
where (CASE WHEN $P{USUARIO}>0 THEN us.id=$P{USUARIO} ELSE us.id>0 END)
and fa.fecha between to_timestamp($P{DESDE}, 'DD/MM/YYYY HH24:MI')::timestamp without  time zone AND
to_timestamp($P{HASTA}, 'DD/MM/YYYY HH24:MI')::timestamp without time zone AND fa.estado = true
)
as total_pagar, us.usuario,
initcap(coalesce(ente_usuario.nombres,'')||' '||coalesce(ente_usuario.apellidos,'')) recaudador

from flow.regp_liquidacion
left join app.acl_user us on (us.id = $P{USUARIO})
left join app.cat_ente ente_usuario on ente_usuario.id = us.ente
where reingreso = false and estado_liquidacion = 2 and
(CASE WHEN $P{USUARIO}>0 THEN user_ingreso=$P{USUARIO} ELSE user_ingreso>0 END)
and fecha_ingreso between to_timestamp($P{DESDE}, 'DD/MM/YYYY HH24:MI')::timestamp without time zone AND to_timestamp($P{HASTA}, 'DD/MM/YYYY HH24:MI')::timestamp without time zone
group by 2,3]]>
	</queryString>
	<field name="total_pagar" class="java.math.BigDecimal"/>
	<field name="usuario" class="java.lang.String"/>
	<field name="recaudador" class="java.lang.String"/>
	<background>
		<band height="842" splitType="Stretch">
			<image scaleImage="FillFrame" hAlign="Center" vAlign="Middle">
				<reportElement x="0" y="0" width="555" height="842" uuid="7466f704-5e8f-4578-9c8e-32393baf0b60"/>
				<imageExpression><![CDATA[$P{IMG_URL}]]></imageExpression>
			</image>
		</band>
	</background>
	<pageHeader>
		<band height="130" splitType="Stretch">
			<staticText>
				<reportElement style="negrita" x="0" y="80" width="555" height="20" uuid="644a3b00-a23b-47aa-857d-5577f9df6428"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="false"/>
				</textElement>
				<text><![CDATA[REPORTE DE RECAUDACIÓN - FORMAS DE PAGO]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="45" y="100" width="128" height="14" uuid="1f0f2a71-fcf1-48b8-8bd8-30b2e948ac43"/>
				<textFieldExpression><![CDATA[$P{DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="1" y="100" width="44" height="14" uuid="08303ed9-700f-4820-a431-300d85b9e279"/>
				<text><![CDATA[Desde:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="256" y="114" width="218" height="14" uuid="5c2ae979-40a2-4896-8519-4d1fa1456b20"/>
				<textFieldExpression><![CDATA[$P{USUARIO} == 0 ? "TODOS" : $F{recaudador}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="201" y="114" width="55" height="14" uuid="5ae6dc52-45e5-4e6c-a297-275ff782c293"/>
				<text><![CDATA[Cajero:]]></text>
			</staticText>
			<staticText>
				<reportElement x="201" y="100" width="123" height="14" uuid="d18a6b11-8850-46a3-b2ff-a3e86333fa77"/>
				<text><![CDATA[Fecha de Impresión:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement x="324" y="100" width="150" height="14" uuid="eb8e24d5-3b63-42d7-8818-7c811d162c74"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="128" width="555" height="1" uuid="24b95810-c346-42d4-8ba7-75fbf73a28c7"/>
			</line>
			<staticText>
				<reportElement x="1" y="114" width="44" height="14" uuid="67cb7064-c22c-460c-94ef-952c42b00042"/>
				<text><![CDATA[Hasta:]]></text>
			</staticText>
			<textField>
				<reportElement x="45" y="114" width="128" height="14" uuid="0a3cd59c-74b9-4bfa-a23c-3a861afdf327"/>
				<textFieldExpression><![CDATA[$P{HASTA_STRING}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="75" splitType="Stretch">
			<subreport>
				<reportElement positionType="Float" x="0" y="60" width="555" height="15" isRemoveLineWhenBlank="true" uuid="a76ba852-e2cc-481f-b247-e78fcb73ec79"/>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_tajeta.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="15" width="555" height="15" isRemoveLineWhenBlank="true" uuid="0d587976-c3cf-4454-baf6-1de96201cc6a"/>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_cheque.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="30" width="555" height="15" isRemoveLineWhenBlank="true" uuid="8bf2b917-e924-446c-b8b7-ff7d40661de5"/>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_nota_credito.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="45" width="555" height="15" isRemoveLineWhenBlank="true" uuid="5cb792c7-5ed1-484f-9377-cadc8ec01fe2"/>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_transferencia.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="0" width="555" height="15" isRemoveLineWhenBlank="true" uuid="8bea317b-92bb-426c-8f3f-f016f99a6783"/>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_efectivo.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</detail>
	<pageFooter>
		<band height="45" splitType="Stretch">
			<textField evaluationTime="Report">
				<reportElement x="529" y="2" width="25" height="14" uuid="0d00c760-9faa-4f19-9c66-27f50d8ff9a7"/>
				<textElement verticalAlignment="Bottom">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement positionType="Float" x="490" y="2" width="39" height="14" uuid="563e37c1-4dc0-4242-9628-1489fc56649d"/>
				<textElement verticalAlignment="Bottom">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Pág "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="115" y="2" width="123" height="14" uuid="039acba7-08d7-4b95-a529-58cda7bf8bc9"/>
				<text><![CDATA[Fecha de Impresión:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement x="238" y="2" width="150" height="14" uuid="91b38cc3-a1b6-4c99-a59c-6b2fae77d5de"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="118" splitType="Stretch">
			<staticText>
				<reportElement style="negrita" x="336" y="28" width="100" height="14" uuid="ec7ff972-6ee9-4175-b549-633647aeb9bc"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[TOTAL NETO:]]></text>
			</staticText>
			<textField pattern="¤ #,##0.00" isBlankWhenNull="true">
				<reportElement x="436" y="0" width="118" height="14" uuid="1999b4ec-ce78-45bf-aa67-58b353f92e8c"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total_pagar}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="336" y="0" width="100" height="14" uuid="959a3404-91e0-4c1e-a828-80491073a732"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[TOTAL BRUTO:]]></text>
			</staticText>
			<staticText>
				<reportElement x="336" y="14" width="100" height="14" uuid="46897a6b-8ffd-4a4c-a96b-35917cbee5ad"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[NOTAS DE CRÉDITO:]]></text>
			</staticText>
			<subreport>
				<reportElement x="475" y="14" width="80" height="28" uuid="027e3ae4-9520-4cd1-8821-100e2afe3db4"/>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="VALOR_TOTAL">
					<subreportParameterExpression><![CDATA[$F{total_pagar}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "cuadreCaja_valor_nc.jasper"]]></subreportExpression>
			</subreport>
			<textField isBlankWhenNull="true">
				<reportElement x="1" y="57" width="256" height="16" uuid="1e7371af-8659-466a-a5a3-1918d6f15340"/>
				<box leftPadding="2">
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["GENERADO POR"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="negrita" x="1" y="73" width="256" height="45" uuid="9846b540-9d46-440e-8418-224c67d95f4b"/>
				<box leftPadding="2">
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement verticalAlignment="Bottom"/>
				<textFieldExpression><![CDATA[$P{TESORERA}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="298" y="57" width="256" height="16" uuid="22438408-4007-448c-ac0e-7fbe5f3724ad"/>
				<box leftPadding="2">
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["RECIBIDO POR"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement style="negrita" x="298" y="73" width="256" height="45" uuid="d9211b86-d6ef-455e-ad09-11aaaae5bee5"/>
				<box leftPadding="2">
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom"/>
			</textField>
		</band>
	</summary>
</jasperReport>
