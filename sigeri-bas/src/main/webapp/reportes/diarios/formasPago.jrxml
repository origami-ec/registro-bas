<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="formasPago" language="groovy" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="0" bottomMargin="0" uuid="94bbb19a-bcdb-49a3-91a6-abb3527833e7">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="negrita" pdfFontName="Helvetica-Bold"/>
	<parameter name="IMG_URL" class="java.lang.String"/>
	<parameter name="DESDE" class="java.lang.String"/>
	<parameter name="USUARIO" class="java.lang.Long"/>
	<parameter name="TOTAL" class="java.math.BigDecimal"/>
	<parameter name="CANTIDAD" class="java.lang.Integer"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\Users\\Anyelo\\Desktop\\NetBeansProjects\\portoviejo-registro\\src\\main\\webapp\\reportes\\diarios\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="HASTA" class="java.lang.String"/>
	<parameter name="HASTA_STRING" class="java.lang.String"/>
	<parameter name="TESORERA" class="java.lang.String"/>
	<parameter name="COORDINADORA" class="java.lang.String"/>
	<parameter name="CONTADORA" class="java.lang.String"/>
	<queryString>
		<![CDATA[select sum(total_pagar)
+
(
SELECT coalesce(SUM(total_pagar),0) FROM financiero.ren_factura fa
left join financiero.ren_cajero ca on ca.id = fa.caja
left join app.acl_user us on us.id = ca.usuario
where (CASE WHEN $P{USUARIO}>0 THEN us.id=$P{USUARIO} ELSE us.id>0 END)
and fa.fecha between to_timestamp($P{DESDE}, 'DD/MM/YYYY HH24:MI')::timestamp without  time zone AND
to_timestamp($P{HASTA}, 'DD/MM/YYYY HH24:MI')::timestamp without time zone AND fa.estado = true
)
as total_pagar, us.usuario,
initcap(coalesce(ente_usuario.nombres,'')||' '||coalesce(ente_usuario.apellidos,'')) recaudador

from flow.regp_liquidacion
left join app.acl_user us on (us.id = $P{USUARIO})
left join app.cat_ente ente_usuario on ente_usuario.id = us.ente
where reingreso = false and estado_liquidacion = 2 and
(CASE WHEN $P{USUARIO}>0 THEN user_ingreso=$P{USUARIO} ELSE user_ingreso>0 END)
and fecha_ingreso between to_timestamp($P{DESDE}, 'DD/MM/YYYY HH24:MI')::timestamp without time zone AND to_timestamp($P{HASTA}, 'DD/MM/YYYY HH24:MI')::timestamp without time zone
group by 2,3]]>
	</queryString>
	<field name="total_pagar" class="java.math.BigDecimal"/>
	<field name="usuario" class="java.lang.String"/>
	<field name="recaudador" class="java.lang.String"/>
	<background>
		<band height="842" splitType="Stretch">
			<image scaleImage="FillFrame" hAlign="Center" vAlign="Middle">
				<reportElement x="-20" y="0" width="594" height="842" uuid="6acaf281-f068-4658-9e04-9e4538c12f3d"/>
				<imageExpression><![CDATA[$P{IMG_URL}]]></imageExpression>
			</image>
		</band>
	</background>
	<pageHeader>
		<band height="142" splitType="Stretch">
			<staticText>
				<reportElement style="negrita" x="0" y="80" width="555" height="18" uuid="2d7ef14e-f4f9-48e9-8788-956664ceeba1"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="false"/>
				</textElement>
				<text><![CDATA[REPORTE DE RECAUDACIÓN - FORMAS DE PAGO]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="45" y="98" width="128" height="14" uuid="779ee0d9-0bee-4b13-b377-25d2bbe484ed"/>
				<textFieldExpression><![CDATA[$P{DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="1" y="98" width="44" height="14" uuid="a8b0e5b7-f69a-4d05-9bc4-8b711416818b"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Desde:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="256" y="112" width="218" height="14" uuid="24651db0-1633-428b-ae80-0ebc27a8cb6d"/>
				<textFieldExpression><![CDATA[$P{USUARIO} == 0 ? "TODOS" : $F{recaudador}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="201" y="112" width="55" height="14" uuid="23898c73-2135-42b2-ac13-411f80b654d3"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Cajero:]]></text>
			</staticText>
			<staticText>
				<reportElement x="201" y="98" width="123" height="14" uuid="4b374c42-0e22-4566-8f3d-ff1fb7f65dd3"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha de Impresión:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH:mm">
				<reportElement x="324" y="98" width="150" height="14" uuid="73d5e4ba-fdd0-44bd-8912-268962aedbe2"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="140" width="555" height="1" uuid="e3905aba-4d95-4d18-956d-4c70d31c50a3"/>
			</line>
			<staticText>
				<reportElement x="1" y="112" width="44" height="14" uuid="7906fbb7-7262-4072-a96a-c5fbb36e0228"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Hasta:]]></text>
			</staticText>
			<textField>
				<reportElement x="45" y="112" width="128" height="14" uuid="2b369405-e627-4f5b-ab23-922ddc7c5acc"/>
				<textFieldExpression><![CDATA[$P{HASTA_STRING}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="1" y="126" width="44" height="14" uuid="f20e1da3-cec4-41b2-b367-30a162a3a08c"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Para:]]></text>
			</staticText>
			<staticText>
				<reportElement x="45" y="126" width="128" height="14" uuid="a57e0710-c79c-4039-97a6-f2505b1068ea"/>
				<textElement verticalAlignment="Middle"/>
				<text><![CDATA[Tesorería]]></text>
			</staticText>
			<textField evaluationTime="Report">
				<reportElement x="530" y="126" width="25" height="14" uuid="54585a11-3c09-4c3d-88ec-794ff55b41d6"/>
				<textElement verticalAlignment="Bottom">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="491" y="126" width="39" height="14" uuid="8301d906-1619-4d76-930f-32b9141ae7c9"/>
				<textElement verticalAlignment="Bottom">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Pág "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="122" splitType="Stretch">
			<subreport>
				<reportElement positionType="Float" x="0" y="80" width="555" height="20" isRemoveLineWhenBlank="true" uuid="87731c67-3e9a-49d9-abd9-5238d339e04c"/>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_transferencia.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="40" width="555" height="20" isRemoveLineWhenBlank="true" uuid="e9ed6287-4db5-440a-a120-22acfeade407"/>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_cheque.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="20" width="555" height="20" isRemoveLineWhenBlank="true" uuid="b450dce7-8a5b-4182-a6e2-d4da540275af"/>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_nota_credito.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="0" width="555" height="20" isRemoveLineWhenBlank="true" uuid="8048b1fe-59bd-45b9-844e-996344c805c9"/>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_efectivo.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="60" width="555" height="20" isRemoveLineWhenBlank="true" uuid="c9d364b5-991a-4a77-ab7b-e9d7ca6e494b"/>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_tarjeta.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="100" width="555" height="20" isRemoveLineWhenBlank="true" uuid="ed927d95-bb20-41e6-973d-9a6b6a154f6b"/>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "formasPago_online.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</detail>
	<pageFooter>
		<band height="60" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="130" splitType="Stretch">
			<staticText>
				<reportElement x="337" y="3" width="100" height="14" uuid="3c5a5573-b4b4-4f20-8169-ffdcb2f86a41"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[TOTAL BRUTO:]]></text>
			</staticText>
			<textField pattern="¤ #,##0.00" isBlankWhenNull="true">
				<reportElement x="437" y="3" width="118" height="14" uuid="26de1696-76d2-42d4-a8c4-013fd43ae305"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total_pagar}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="negrita" x="338" y="31" width="98" height="14" uuid="ea3d8c38-319c-44f4-b74f-f159ab3a7b50"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[TOTAL NETO:]]></text>
			</staticText>
			<staticText>
				<reportElement x="338" y="17" width="98" height="14" uuid="4e8bfd9c-8a6f-4674-9b18-65c24218926c"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[NOTAS DE CRÉDITO:]]></text>
			</staticText>
			<subreport>
				<reportElement x="475" y="17" width="80" height="28" uuid="c115f179-0c43-4be4-aba5-e6ab665add05"/>
				<subreportParameter name="HASTA">
					<subreportParameterExpression><![CDATA[$P{HASTA}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="USUARIO">
					<subreportParameterExpression><![CDATA[$P{USUARIO}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="VALOR_TOTAL">
					<subreportParameterExpression><![CDATA[$F{total_pagar}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="DESDE">
					<subreportParameterExpression><![CDATA[$P{DESDE}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "cuadreCaja_valor_nc.jasper"]]></subreportExpression>
			</subreport>
			<staticText>
				<reportElement x="322" y="82" width="150" height="20" uuid="9bfbfc20-025a-491a-906c-6dbcde50be00"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[RECIBIDO POR:]]></text>
			</staticText>
			<staticText>
				<reportElement x="73" y="82" width="150" height="20" uuid="824558b9-4e50-4e84-81fb-223a9c12f219"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[ELABORADO POR:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="73" y="101" width="150" height="14" isPrintWhenDetailOverflows="true" uuid="29b38efc-b970-4b92-baa8-448144dc710b"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{USUARIO} == 0L ? "TODOS" : $F{usuario}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="73" y="114" width="150" height="14" uuid="4fafc9f0-5962-4166-a177-6417d7ae2eb3"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Recaudador(a) Caja No.:]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
