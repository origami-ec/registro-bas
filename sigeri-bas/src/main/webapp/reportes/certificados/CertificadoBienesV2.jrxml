<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="CertificadoGravamen" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="495" leftMargin="50" rightMargin="50" topMargin="0" bottomMargin="0" uuid="b0616992-c4f9-44e8-b8e6-4e352538c377">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="negrita" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica-Bold"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["C:\\Users\\Anyelo\\Desktop\\NetBeansProjects\\portoviejo-registro\\src\\main\\webapp\\reportes\\registro\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="ID_CERTIFICADO" class="java.lang.Long"/>
	<parameter name="REGISTRADOR" class="java.lang.String"/>
	<parameter name="HEADER_URL" class="java.lang.String"/>
	<parameter name="WATERMARK_URL" class="java.lang.String"/>
	<parameter name="FOOTER_URL" class="java.lang.String"/>
	<parameter name="NOMBRES" class="java.lang.String"/>
	<parameter name="FIRMA_DIGITAL" class="java.lang.String"/>
	<queryString>
		<![CDATA[select (to_char(ce.fecha_emision, 'yyyy')||'-'||ce.num_tramite)
as codigo_certificado, ce.num_certificado, ce.fecha_emision, ce.observacion
as solvencia, liq.codigo_comprobante, ce.fecha_creacion as fecha_certificado,
(select razon_reporte from app.reg_registrador where actual is true)
as accion_personal, ce.nombre_solicitante, ce.uso_documento,
ce.cod_verificacion, liq.tramite_online,
'C' || ce.cod_verificacion as qrcode, num_tramite, cr.usuario as user_certificado
from app.reg_certificado ce
left join flow.regp_tareas_tramite tt on tt.id = ce.tarea_tramite
left join flow.regp_liquidacion_detalles ld on ld.id = tt.detalle
left join flow.regp_liquidacion liq on liq.id = ld.liquidacion
left join app.acl_user cr on (cr.id = ce.user_creador)
where ce.id = $P{ID_CERTIFICADO}]]>
	</queryString>
	<field name="codigo_certificado" class="java.lang.String"/>
	<field name="num_certificado" class="java.lang.Long"/>
	<field name="fecha_emision" class="java.sql.Timestamp"/>
	<field name="solvencia" class="java.lang.String"/>
	<field name="codigo_comprobante" class="java.lang.String"/>
	<field name="fecha_certificado" class="java.sql.Timestamp"/>
	<field name="accion_personal" class="java.lang.String"/>
	<field name="nombre_solicitante" class="java.lang.String"/>
	<field name="uso_documento" class="java.lang.String"/>
	<field name="cod_verificacion" class="java.lang.String"/>
	<field name="tramite_online" class="java.lang.Boolean"/>
	<field name="qrcode" class="java.lang.String"/>
	<field name="num_tramite" class="java.lang.Long"/>
	<field name="user_certificado" class="java.lang.String"/>
	<background>
		<band height="842" splitType="Stretch">
			<image scaleImage="FillFrame" hAlign="Center" vAlign="Middle">
				<reportElement x="-12" y="10" width="520" height="825" uuid="e16a321f-056d-4a36-bb33-bb6e8cb1cba2"/>
				<imageExpression><![CDATA[$P{WATERMARK_URL}]]></imageExpression>
			</image>
		</band>
	</background>
	<pageHeader>
		<band height="121" splitType="Stretch">
			<staticText>
				<reportElement style="negrita" mode="Opaque" x="0" y="105" width="495" height="16" backcolor="#CCCCCC" uuid="7030bfdd-51b7-4530-b1b8-9cb093aefc8e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="false"/>
				</textElement>
				<text><![CDATA[CERTIFICADO DE GRAVÁMEN]]></text>
			</staticText>
		</band>
	</pageHeader>
	<detail>
		<band height="18" splitType="Stretch">
			<subreport>
				<reportElement x="0" y="2" width="495" height="13" uuid="48c70337-c2d2-43a0-953b-6d971333e640"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="ID_CERTIFICADO">
					<subreportParameterExpression><![CDATA[$P{ID_CERTIFICADO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "CertificadoGravamenDetalles.jasper"]]></subreportExpression>
			</subreport>
		</band>
		<band height="25" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="0" y="0" width="495" height="19" isRemoveLineWhenBlank="true" uuid="00267dca-256f-4535-bdf1-31c53d86e606">
					<printWhenExpression><![CDATA[$F{solvencia} != null && !$F{solvencia}.isEmpty()]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="styled">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA["<style pdfFontName=\"Helvetica-Bold\">SE CERTIFICA HASTA LA PRESENTE FECHA QUE: </style> " +
$F{solvencia}.toUpperCase()]]></textFieldExpression>
			</textField>
		</band>
		<band height="42" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="8" width="495" height="8" isRemoveLineWhenBlank="true" uuid="5dc5e887-dcd5-4543-b6d9-c2c5d966c51b"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["DE LA VIGENCIA: La presente certificación se confiere según los registros que constan en la BASE DE DATOS del Registro de la Propiedad Inmobiliaria y Mercantil del Cantón Latacunga, válidos e ingresados hasta la presente fecha, la que tendrá plena vigencia por un periodo de un mes contando a partir de la fecha de emisión, salvo que antes se modifique algún dato del contenido de la información registral."]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="0" width="495" height="8" isRemoveLineWhenBlank="true" uuid="e7fcf604-7790-44dc-8d37-b216c3b03b34"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["NOTAS ACLARATORIAS: "]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="16" width="495" height="8" isRemoveLineWhenBlank="true" uuid="3591054e-53dc-46c0-afd2-c4266eb02f24"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["DE LA VALIDACIÓN: Para validar la vigencia de la información favor ingresar el código de verificación del documento en la página web del Registro de la Propiedad Inmobiliaria y Mercantil del Cantón Latacunga o leyendo el código QR desde la aplicación móvil oficial."]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="24" width="495" height="8" isRemoveLineWhenBlank="true" uuid="352f7d0d-42c7-47f5-9149-38dbc7504c66"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["DE LA NORMATIVA LEGAL: Esta certificación ha sido emitida con sustento en los artículos 2, 6, 7, 13 y 51 de la Ley de Comercio Electrónico, Firmas Electrónicas y Mensajes de Datos, artículo 3 inciso 3 de la Ley Orgánica del Sistema Nacional de Registro de Datos Públicos, artículo 202 del Código Orgánico General de Procesos y demás normativa aplicable, así como en el instructivo para la emisión de certificados en línea."]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="32" width="495" height="8" isRemoveLineWhenBlank="true" uuid="54bb1f0d-fbe5-4fe4-91d1-eb0626884379"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["DE LA RECTIFICACIÓN: En el caso de detectar una información errónea que contenga este certificado, el usuario puede solicitar la rectificación en el Registro de la Propiedad Inmobiliaria y Mercantil del Cantón Latacunga."]]></textFieldExpression>
			</textField>
		</band>
		<band height="126" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement style="negrita" x="0" y="98" width="250" height="28" isPrintWhenDetailOverflows="true" uuid="0aa7260c-bc25-4768-b731-f4e0d77b9331"/>
				<box>
					<topPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{REGISTRADOR}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="340" y="0" width="155" height="16" isPrintWhenDetailOverflows="true" uuid="82ca22af-aae1-4e18-a09e-326b19b7bd1b">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Middle"/>
				<text><![CDATA[Código de Verificación]]></text>
			</staticText>
			<textField>
				<reportElement style="negrita" x="340" y="16" width="155" height="20" isPrintWhenDetailOverflows="true" uuid="6a94bead-84f5-4d55-9bad-0a51058a49ad">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="14" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cod_verificacion}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="405" y="36" width="90" height="90" isPrintWhenDetailOverflows="true" uuid="3c3c3c4b-9715-4984-9b6b-922221f56ba0">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<imageExpression><![CDATA[com.google.zxing.client.j2se.MatrixToImageWriter.toBufferedImage(
    new com.google.zxing.qrcode.QRCodeWriter().encode(
        $F{qrcode},
        com.google.zxing.BarcodeFormat.QR_CODE, 300, 300
    ))]]></imageExpression>
			</image>
		</band>
	</detail>
	<pageFooter>
		<band height="65" splitType="Stretch">
			<textField>
				<reportElement x="394" y="0" width="59" height="12" uuid="3cf6d0cc-4a60-4aa4-96e1-6fe575a8bc19"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="453" y="0" width="42" height="12" uuid="6edb0fb7-b9be-4194-86ec-70dc568b0d93"/>
				<textElement>
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="negrita" x="0" y="0" width="393" height="12" uuid="a7ed4f0c-2443-4ebe-8529-8fb44a1306fb"/>
				<box rightPadding="2"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<text><![CDATA[VALIDEZ DEL CERTIFICADO TÉRMINO DE 30 DÍAS A PARTIR DE LA FECHA DE EMISIÓN]]></text>
			</staticText>
			<staticText>
				<reportElement x="70" y="12" width="70" height="10" isPrintWhenDetailOverflows="true" uuid="e3e81dfc-b97c-4a24-8f3e-f7455d38bff2"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<text><![CDATA[Nº de Certificado:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement x="140" y="12" width="120" height="10" isPrintWhenDetailOverflows="true" uuid="91d1f557-c157-4ac4-b19d-21c3ba93723b"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[java.lang.String.format("%08d", $F{num_certificado})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="70" y="22" width="70" height="10" isPrintWhenDetailOverflows="true" uuid="e106c72a-90a8-4eef-9e08-3c3dd82e935a"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<text><![CDATA[Fecha Emisión:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH:mm" isBlankWhenNull="true">
				<reportElement x="140" y="22" width="120" height="10" isPrintWhenDetailOverflows="true" uuid="25f81366-de4b-47d5-b811-2569086d2ee4"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha_emision}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="70" y="32" width="70" height="10" isPrintWhenDetailOverflows="true" uuid="42039812-01af-4d11-a727-deb11dc9aaa8"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<text><![CDATA[Certificador:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement x="140" y="32" width="120" height="10" isPrintWhenDetailOverflows="true" uuid="dec98d36-6253-4804-b514-6d08e9fed1f3"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{user_certificado}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="260" y="12" width="70" height="10" isPrintWhenDetailOverflows="true" uuid="daa499b1-59b5-4ca1-acc2-b5e4979df903"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<text><![CDATA[N° de Trámite:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement x="330" y="12" width="120" height="10" isPrintWhenDetailOverflows="true" uuid="65732c64-f80f-4946-86e6-0a3d75358ede"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{codigo_certificado}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="260" y="22" width="70" height="10" isPrintWhenDetailOverflows="true" uuid="b925fdc8-114f-4837-bfd9-8f98452679ff"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<text><![CDATA[N° de Factura:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement x="330" y="22" width="120" height="10" isPrintWhenDetailOverflows="true" uuid="28bbb2fd-220f-4a1a-9b19-32240fc680d3"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{codigo_comprobante}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
