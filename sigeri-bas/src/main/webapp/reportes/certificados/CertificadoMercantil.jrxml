<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="CertificadoMercantil" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="495" leftMargin="50" rightMargin="50" topMargin="0" bottomMargin="0" isFloatColumnFooter="true" uuid="eaca66aa-9595-4c19-ac4e-47317721d91a">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="negrita" pdfFontName="Helvetica-Bold"/>
	<parameter name="ID_CERTIFICADO" class="java.lang.Long"/>
	<parameter name="WATERMARK_URL" class="java.lang.String"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\app_server\\apache-tomee-plus-1.7.1\\webapps\\rpp\\reportes\\registro\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="REGISTRADOR" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT c.num_certificado, c.tipo_certificado, c.estado_mensaje,
coalesce(en.apellidos, '') || ' ' || coalesce(en.nombres, '') as usuario,
(to_char(c.fecha_emision, 'yyyy')||'-'||c.num_tramite)
as codigo_certificado, fi.num_ficha, c.con_bienes, ac.nombre as nombre_certificado,
c.cod_verificacion, 'C' || c.cod_verificacion as qrcode,
c.nombre_solicitante, c.uso_documento, us.usuario as certificador,
c.fecha_emision, liq.codigo_comprobante
FROM app.reg_certificado c
left join app.acl_user us on (us.id = c.user_creador)
left join app.cat_ente en on (en.id = us.ente)
left join flow.regp_tareas_tramite tt on (tt.id = c.tarea_tramite)
left join flow.regp_liquidacion_detalles de on (de.id = tt.detalle)
left join flow.regp_liquidacion liq on liq.id = de.liquidacion
left join app.reg_acto ac on (de.acto = ac.id)
left join app.reg_libro li on (li.id = ac.libro)
left join app.reg_ficha fi on (fi.id = c.ficha)
where c.id = $P{ID_CERTIFICADO}]]>
	</queryString>
	<field name="num_certificado" class="java.lang.Long"/>
	<field name="tipo_certificado" class="java.lang.Long"/>
	<field name="estado_mensaje" class="java.lang.Integer"/>
	<field name="usuario" class="java.lang.String"/>
	<field name="codigo_certificado" class="java.lang.String"/>
	<field name="num_ficha" class="java.lang.Long"/>
	<field name="con_bienes" class="java.lang.Boolean"/>
	<field name="nombre_certificado" class="java.lang.String"/>
	<field name="cod_verificacion" class="java.lang.String"/>
	<field name="qrcode" class="java.lang.String"/>
	<field name="nombre_solicitante" class="java.lang.String"/>
	<field name="uso_documento" class="java.lang.String"/>
	<field name="certificador" class="java.lang.String"/>
	<field name="fecha_emision" class="java.sql.Timestamp"/>
	<field name="codigo_comprobante" class="java.lang.String"/>
	<background>
		<band height="840" splitType="Stretch">
			<image scaleImage="FillFrame" hAlign="Center" vAlign="Middle">
				<reportElement x="-10" y="10" width="515" height="830" uuid="4977f6a7-c9b5-4deb-a7e4-b5181d4c2e45"/>
				<imageExpression><![CDATA[$P{WATERMARK_URL}]]></imageExpression>
			</image>
		</band>
	</background>
	<pageHeader>
		<band height="105" splitType="Stretch"/>
	</pageHeader>
	<detail>
		<band height="60" splitType="Stretch">
			<staticText>
				<reportElement style="negrita" mode="Opaque" x="0" y="28" width="495" height="17" forecolor="#000000" backcolor="#CCCCCC" uuid="c931ce8b-8533-4bf3-89e8-76a46b1ab19b"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="false"/>
				</textElement>
				<text><![CDATA[CERTIFICACIÓN MERCANTIL]]></text>
			</staticText>
			<staticText>
				<reportElement style="negrita" positionType="Float" x="0" y="0" width="130" height="14" uuid="5bf4b59c-ac50-4453-beb6-5233f43c785f"/>
				<textElement verticalAlignment="Middle">
					<font size="11" isBold="false"/>
				</textElement>
				<text><![CDATA[Nº de Certificado:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement positionType="Float" x="130" y="14" width="265" height="14" uuid="d69ab815-796f-4e0e-8dc2-c817c46e3f45"/>
				<textElement verticalAlignment="Middle">
					<font size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha_emision}]]></textFieldExpression>
				<patternExpression><![CDATA["dd MMMMM yyyy HH:mm"]]></patternExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement positionType="Float" x="130" y="0" width="265" height="14" uuid="5b2105c3-9143-48df-8899-abe53a34ae0b"/>
				<textElement verticalAlignment="Middle">
					<font size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[java.lang.String.format("%08d", $F{num_certificado}) + "-" + $F{codigo_certificado}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="negrita" positionType="Float" x="0" y="14" width="130" height="14" uuid="d2a6774d-6fcc-435c-91ec-63c39ee78ea1"/>
				<textElement verticalAlignment="Middle">
					<font size="11" isBold="false"/>
				</textElement>
				<text><![CDATA[Fecha de Emisión:]]></text>
			</staticText>
		</band>
		<band height="20" splitType="Stretch">
			<subreport>
				<reportElement x="0" y="0" width="495" height="18" uuid="49896668-52b3-4b5f-98ca-dabb6bfc0f1a"/>
				<subreportParameter name="ID_CERTIFICADO">
					<subreportParameterExpression><![CDATA[$P{ID_CERTIFICADO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "CertificadoGeneral_contenido.jasper"]]></subreportExpression>
			</subreport>
		</band>
		<band height="62" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="0" width="495" height="16" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="9e98196b-a946-41f7-a5ae-1cb59a049ca7"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="styled">
					<font size="11" isBold="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["<style pdfFontName=\"Helvetica-Bold\">MOTIVO: </style>El presente certificado se lo extiende para los fines solicitados por <style pdfFontName=\"Helvetica-Bold\">" + $F{nombre_solicitante}.toUpperCase() +
"</style> el mismo que servirá para <style pdfFontName=\"Helvetica-Bold\">" + $F{uso_documento}.toUpperCase() + "</style> de acuerdo a la solicitud presentada por el usuario."]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="21" width="495" height="8" isRemoveLineWhenBlank="true" uuid="a78c572c-d4e0-42ff-95cf-3cfada902779"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["NOTAS ACLARATORIAS: "]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="29" width="495" height="8" isRemoveLineWhenBlank="true" uuid="8e8e1122-a05c-4cb1-9c58-36061ca45a20"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["DE LA VIGENCIA: La presente certificación se confiere según los registros que constan en la BASE DE DATOS del Registro de la Propiedad Inmobiliaria y Mercantil del Cantón Latacunga, válidos e ingresados hasta la presente fecha, la que tendrá plena vigencia por un periodo de un mes contando a partir de la fecha de emisión, salvo que antes se modifique algún dato del contenido de la información registral."]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="37" width="495" height="8" isRemoveLineWhenBlank="true" uuid="56388acf-3603-4a79-9c8e-6a7f725adbd1"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["DE LA VALIDACIÓN: Para validar la vigencia de la información favor ingresar el código de verificación del documento en la página web del Registro de la Propiedad Inmobiliaria y Mercantil del Cantón Latacunga o leyendo el código QR desde la aplicación móvil oficial."]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="45" width="495" height="8" isRemoveLineWhenBlank="true" uuid="5e3b91d4-2a18-4228-9adb-448e5171a14c"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["DE LA NORMATIVA LEGAL: Esta certificación ha sido emitida con sustento en los artículos 2, 6, 7, 13 y 51 de la Ley de Comercio Electrónico, Firmas Electrónicas y Mensajes de Datos, artículo 3 inciso 3 de la Ley Orgánica del Sistema Nacional de Registro de Datos Públicos, artículo 202 del Código Orgánico General de Procesos y demás normativa aplicable, así como en el instructivo para la emisión de certificados en línea."]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="0" y="53" width="495" height="8" isRemoveLineWhenBlank="true" uuid="1a4e55f0-685d-4501-95c0-022bacc450c2"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle" markup="none">
					<font size="6"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["DE LA RECTIFICACIÓN: En el caso de detectar una información errónea que contenga este certificado, el usuario puede solicitar la rectificación en el Registro de la Propiedad Inmobiliaria y Mercantil del Cantón Latacunga."]]></textFieldExpression>
			</textField>
		</band>
		<band height="130" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement style="negrita" positionType="Float" x="0" y="102" width="250" height="28" isPrintWhenDetailOverflows="true" uuid="12067e34-e233-4232-9c0f-89ae2f615e09"/>
				<box>
					<topPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{REGISTRADOR}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="405" y="40" width="90" height="90" isPrintWhenDetailOverflows="true" uuid="467e01d9-3234-40d0-9665-eb100ccc39f8">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<imageExpression><![CDATA[com.google.zxing.client.j2se.MatrixToImageWriter.toBufferedImage(
    new com.google.zxing.qrcode.QRCodeWriter().encode(
        $F{qrcode},
        com.google.zxing.BarcodeFormat.QR_CODE, 300, 300
    ))]]></imageExpression>
			</image>
			<textField>
				<reportElement style="negrita" x="340" y="16" width="155" height="24" isPrintWhenDetailOverflows="true" uuid="62b15f31-d1e0-4c7f-a47d-35378c3b9c0d">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="18" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cod_verificacion}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="340" y="0" width="155" height="16" isPrintWhenDetailOverflows="true" uuid="867045d8-77d9-42f9-ad8d-28ddc5b41959">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Middle"/>
				<text><![CDATA[Código de Verificación]]></text>
			</staticText>
		</band>
	</detail>
	<pageFooter>
		<band height="60" splitType="Stretch">
			<textField>
				<reportElement x="375" y="0" width="80" height="12" uuid="fe8081b8-d8c0-4b1e-89bc-cfcf2a155a74"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="455" y="0" width="40" height="12" uuid="a4f03298-0fb5-47fb-82c6-687454c1253d"/>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement positionType="Float" x="108" y="28" width="84" height="8" isPrintWhenDetailOverflows="true" uuid="577000eb-ece7-40f5-817e-1e79062b7818"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[N° Trámite:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement positionType="Float" x="192" y="28" width="183" height="8" isPrintWhenDetailOverflows="true" uuid="006fd878-bfa1-48fd-827b-49713e33be4e"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{codigo_certificado}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy HH:mm" isBlankWhenNull="true">
				<reportElement positionType="Float" x="192" y="20" width="183" height="8" uuid="43c17693-8c61-49ec-b61b-e63b9ff48061"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha_emision}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement positionType="Float" x="108" y="20" width="84" height="8" isPrintWhenDetailOverflows="true" uuid="d4ee7a17-4458-4fb8-a761-60a557ae2e44"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Fecha de Emisión:]]></text>
			</staticText>
			<staticText>
				<reportElement positionType="Float" x="108" y="12" width="84" height="8" isPrintWhenDetailOverflows="true" uuid="296e7d94-fd45-4ce4-89a1-8499c78fef1b"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Certificador:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement positionType="Float" x="192" y="12" width="183" height="8" isPrintWhenDetailOverflows="true" uuid="5865edda-f18e-4c51-8de1-0defc0eea7e0"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{certificador}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement positionType="Float" x="108" y="36" width="84" height="8" isPrintWhenDetailOverflows="true" uuid="6aad8db8-4581-46fe-a3f2-0d35b76fac81"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[N° Factura:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement positionType="Float" x="192" y="36" width="183" height="8" isPrintWhenDetailOverflows="true" uuid="83f7d35f-3ec3-48f0-b9b4-d038412e8c26"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{codigo_comprobante}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="negrita" x="0" y="0" width="369" height="12" uuid="a940227e-60cf-4d12-9dba-2c78ab5cd637"/>
				<box rightPadding="2"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<text><![CDATA[VALIDEZ DEL CERTIFICADO TÉRMINO DE 30 DÍAS A PARTIR DE LA FECHA DE EMISIÓN]]></text>
			</staticText>
		</band>
	</pageFooter>
</jasperReport>
