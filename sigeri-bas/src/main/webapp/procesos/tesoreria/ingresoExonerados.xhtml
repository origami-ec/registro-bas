<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                template="/template/bpmTemplate.xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:co="http://xmlns.jcp.org/jsf/composite/co"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="title">Trámites Sin Valor</ui:define>
    <ui:define name="content">
        <h:form id="mainForm">
            <center><h3 style="font-weight: bolder;">INGRESO DE TRÁMITES SIN VALOR</h3></center>
            <p:dataTable paginator="true" lazy="true" rows="10" rowsPerPageTemplate="10, 30, 50" style="text-align: center;" paginatorPosition="bottom"
                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {CurrentPageReport} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         value="#{ingresoExonerados.liquidaciones}" var="liq" emptyMessage="No se encontro liquidaciones..." filterEvent="enter"
                         scrollable="true" scrollWidth="99%" resizableColumns="false">
                <p:column headerText="Acciones" width="130">
                    <p:commandButton icon="pi pi-file-pdf" actionListener="#{ingresoExonerados.showProforma(liq)}"
                                     title="Reimprimir Solicitud No #{liq.numTramiteRp}"/>
                    <p:spacer width="5" height="1"/>
                    <p:commandButton icon="pi pi-wallet" actionListener="#{ingresoExonerados.showTituloCredito(liq)}"
                                     title="Reimprimir Titulo" disabled="#{liq.estadoLiquidacion.id ne 2}" />
                    <p:spacer width="5" height="1"/>
                    <p:commandButton icon="pi pi-send" actionListener="#{ingresoExonerados.ingresarTramite(liq)}"
                                     title="Ingresar Trámite No #{liq.numTramiteRp}" disabled="#{liq.estadoLiquidacion.id ne 1}"/>
                </p:column>
                <p:column headerText="No Tramite" filterBy="#{liq.numTramiteRp}" sortBy="#{liq.numTramiteRp}" width="110" filterStyle="width: 95%">
                    <h:outputText  value="#{liq.numTramiteRp}"/>
                </p:column>
                <p:column headerText="Funcionario Asignado" width="100">
                    <h:outputText value="#{liq.inscriptor.usuario}"/>
                </p:column>
                <p:column headerText="Nro Titulo" filterBy="#{liq.tituloCredito}" width="140" filterStyle="width: 95%">
                    <h:outputText  value="#{liq.tituloCredito}"/>
                </p:column>
                <!--<p:column headerText="No Emision" filterBy="# {liq.codigoComprobante}" width="140" filterStyle="width: 95%">
                    <h:outputText  value="# {liq.codigoComprobante}"/>
                </p:column>-->
                <p:column headerText="CI/RUC" width="150" filterBy="#{liq.beneficiario.ciRuc}" filterStyle="width: 95%;">
                    <h:outputText value="#{liq.beneficiario.ciRuc}"/>
                </p:column>
                <p:column headerText="Nombres" width="300">
                    <h:outputText value="#{liq.beneficiario.nombreCompleto}" style="text-transform: uppercase;"/>
                </p:column>
                <!--<p:column headerText="CI/RUC" width="150" filterBy="# {liq.solicitante.ciRuc}" filterStyle="width: 95%;">
                    <h:outputText value="# {liq.solicitante.ciRuc}"/>
                </p:column>
                <p:column headerText="Apellidos y Nombres" filterBy="# {liq.tramite.nombrePropietario}" filterStyle="width: 95%;" width="300">
                    <h:outputText value="# {liq.tramite.nombrePropietario}" style="text-transform: uppercase;"/>
                </p:column>-->
                <p:column headerText="Repertorio" filterBy="#{liq.repertorio}" width="140" filterStyle="width: 95%">
                    <h:outputText  value="#{liq.repertorio}"/>
                </p:column>
                <p:column headerText="Fech.Solicitud" sortBy="#{liq.fechaCreacion}" width="120">
                    <h:outputText value="#{liq.fechaCreacion}"><f:convertDateTime pattern="dd/MM/yyyy HH:mm"/></h:outputText>
                </p:column>
                <p:column headerText="Fech.Ingreso" sortBy="#{liq.fechaIngreso}" width="120">
                    <h:outputText value="#{liq.fechaIngreso}"><f:convertDateTime pattern="dd/MM/yyyy HH:mm"/></h:outputText>
                </p:column>
                <p:column headerText="Fech.Entrega" width="120">
                    <h:outputText value="#{liq.tramite.fechaEntrega}"><f:convertDateTime pattern="dd/MM/yyyy HH:mm"/></h:outputText>
                </p:column>
                <p:column headerText="Usuario Solicitud" width="100">
                    <h:outputText value="#{ingresoExonerados.getNameUserByIdAclUser(liq.userCreacion)}"/>
                </p:column>
                <p:column headerText="Estado Ingreso" width="100">
                    <h:outputText value="#{liq.estadoLiquidacion.code}"/>
                </p:column>
                <p:column headerText="Usuario Ingreso" width="100">
                    <h:outputText value="#{ingresoExonerados.getNameUserByIdAclUser(liq.userIngreso)}"/>
                </p:column>
                <!--<p:column headerText="Estado Pago" width="120">
                    <h:outputText value="#{liq.estadoPago.code}"/>
                </p:column>
                <p:column headerText="# Autorización" width="135">
                    <h:outputText value="# {liq.numeroAutorizacion}"/>
                </p:column>
                <p:column headerText="Clave de Acceso" width="135">
                    <h:outputText value="# {liq.claveAcceso}"/>
                </p:column>
                <p:column headerText="Factura Exonerada" width="30">
                    <p:outputLabel value="SI" rendered="# {liq.generaFactura}" />
                    <p:outputLabel value="NO" rendered="# {!liq.generaFactura}" />
                </p:column>
                <p:column headerText="Doc" width="40">
                    <p:commandLink actionListener="# {ingresoExonerados.showDlgCorrDoc(liq)}" title="# {liq.numTramiteRp}">
                        <p:graphicImage value="/resources/icons/abrir.png" height="16"/>
                    </p:commandLink>
                </p:column>-->
                <p:column headerText="Doc" width="40">
                    <p:commandButton icon="pi pi-tag" actionListener="#{ingresoExonerados.showTicket(liq)}" 
                                     title="Reimprimir Ticket No #{liq.numTramiteRp}" disabled="#{liq.estadoLiquidacion.id ne 2}" />

                </p:column>
            </p:dataTable>
        </h:form>

        <p:dialog id="dlgIngreso" header="Ingreso de Tramite" widgetVar="dlgIngresoTramite" resizable="false"
                  modal="true" closeOnEscape="true" width="400">
            <h:form id="formIngreso">
                <p:panelGrid styleClass="noBorder" style="text-align: center;font-weight: bolder;width: 100%;" columns="1">
                    <p:outputLabel value="Tipo de Ingreso:"/>
                    <p:selectOneMenu value="#{ingresoExonerados.tipoIngreso}">
                        <f:selectItem itemLabel="Seleccione" itemValue="0" />
                        <f:selectItem itemLabel="Transaccion" itemValue="1" />
                        <f:selectItem itemLabel="Ctas por Cobrar" itemValue="2" />
                        <f:selectItem itemLabel="Compensacion" itemValue="3" />
                    </p:selectOneMenu>
                    <p:commandButton value="Ingresar" icon="ui-icon-check" styleClass="btnStyle"
                                     actionListener="#{ingresoExonerados.procesarLiquidacion()}"/>
                </p:panelGrid>
            </h:form>
        </p:dialog>

        <p:dialog id="dlgExonerado" header="Ingreso de Tramite Exonerado" widgetVar="dlgIngresoExo" resizable="false"
                  modal="true" closeOnEscape="true" width="600" >
            <h:form id="formIngresoExo">
                <h:panelGrid columns="2" style="font-weight: bold;font-size: 14px;">
                    Nro. Trámite:
                    <p:inputText value="#{ingresoExonerados.liquidacion.numTramiteRp}" readonly="true" size="60"/>
                    CI/RUC:
                    <p:inputText value="#{ingresoExonerados.liquidacion.beneficiario.ciRuc}" readonly="true" size="60"/>
                    Cliente:
                    <p:inputText value="#{ingresoExonerados.liquidacion.beneficiario.nombreCompleto}" readonly="true" size="60"/>
                    Telefono:
                    <p:inputText value="#{ingresoExonerados.liquidacion.beneficiario.telefono1}" readonly="true" size="60"/>
                    Correo:
                    <p:inputText value="#{ingresoExonerados.liquidacion.beneficiario.correo1}" readonly="true" size="60"/>
                    Direccion:
                    <p:inputText value="#{ingresoExonerados.liquidacion.beneficiario.direccion}" readonly="true" size="60"/>
                </h:panelGrid>
                <p:dataTable value="#{ingresoExonerados.liquidacion.regpLiquidacionDetallesCollection}" var="det" style="text-align: center;"
                             scrollable="true" scrollHeight="150">
                    <p:column headerText="Contrato" >#{det.acto.nombre}</p:column>
                    <p:column headerText="Total" width="80">#{det.valorTotal}</p:column>
                </p:dataTable><br/>
                <div align="center">
                    <p:commandButton value="Ingresar Trámite" icon="pi pi-save" actionListener="#{ingresoExonerados.ingresarTramiteSinValor()}"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog id="dglEstudioJuridico" widgetVar="estudioJuridico" header="Estudio Juridico" resizable="false" modal="true">
            <h:form id="formEstudioJuridico">
                <p:panelGrid styleClass="noBorder">
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Nombre:" style="font-weight: bolder;font-size: 12px"/>
                        </p:column>
                        <p:column>
                            <p:inputText value="#{ingresoExonerados.estudioJuridicoNuevo.valor}" size="40" maxlength="50"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2">
                            <center><p:commandButton value="Guardar" icon="ui-icon-check" styleClass="btnStyle" actionListener="#{ingresoExonerados.guardarEstudioJuridico()}"/></center>
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dlgUsuarioAsignado" header="ASIGNACION DE TRAMITE" modal="true" resizable="false" position="center"
                  closable="false" closeOnEscape="false">
            <h:form id="formUserAsignado">
                <h:panelGrid columns="1" style="text-align: center;font-weight: bolder;">
                    <p:outputLabel value="USUARIO ASIGNADO:" style="font-size: 16px;"/>
                    <p:outputLabel value="#{ingresoExonerados.liquidacion.inscriptor.usuario}" style="font-size: 30px;color: #0033FF"/>
                    <p:commandButton value="ACEPTAR" icon=" pi pi-save" actionListener="#{ingresoExonerados.continuarCobro()}" />
                </h:panelGrid>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dlgTramiteIngresado" header="INGRESAR TRAMITE" modal="true" resizable="false" position="center"
                  closable="false" closeOnEscape="false">
            <h:form id="formTramiteIngresado">
                <h:panelGrid columns="1" style="text-align: center;font-weight: bolder;">
                    <p:outputLabel value="TRAMITE FUE HABILITADO PARA EL INGRESO, DEBE ESPERAR A LA ASIGNACIÓN AUTOMÁTICA."
                                   style="font-size: 16px;"/>
                    <p:commandButton value="ACEPTAR" icon=" pi pi-save" actionListener="#{ingresoExonerados.continuarCobro()}" />
                </h:panelGrid>
            </h:form>
        </p:dialog>

        <!--<p:dialog widgetVar="dlgIngresoTitulo" header="Ingreso de Trámite" resizable="false" modal="true">
            <h:form id="formIngresoTitulo">
                <h:panelGrid columns="1" style="text-align: center;font-weight: bolder;">
                    <p:outputLabel value="La solicitud SI esta Pagada." style="font-weight: bolder;color: blue;"
                                   rendered="# {ingresoExonerados.sld.numEmision ne 0}"/>
                    <p:outputLabel value="La solicitud NO esta Pagada." style="font-weight: bolder;color: red;"
                                   rendered="# {ingresoExonerados.sld.numEmision eq 0}"/>
                    Nro. Título:
                    <p:inputText value="# {ingresoExonerados.sld.numEmision}" readonly="true"/>
                    Fecha de Pago:
                    <p:inputText value="# {ingresoExonerados.sld.fechaPago}" readonly="true" >
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                    </p:inputText>
                    Usuario Cobro:
                    <p:inputText value="# {ingresoExonerados.sld.loginCobro}" readonly="true"/>
                </h:panelGrid><br/>
                <center><p:commandButton value="Cerrar" icon="pi pi-times" onclick="PF('dlgIngresoTitulo').hide()"/></center>
                <center><p:commandButton value="Guardar" icon="pi pi-save" actionListener="# {ingresoExonerados.ingresarTitulo()}"/></center>
            </h:form>
        </p:dialog>-->

    </ui:define>
</ui:composition>
